# ═══════════════════════════════════════════════════════════════
#                    TrendRadar 配置文件
# ═══════════════════════════════════════════════════════════════


# ===============================================================
# 1. 基础设置
# ===============================================================
app:
  timezone: "Asia/Shanghai"
  show_version_update: true


# ===============================================================
# 2. 数据源 - 热榜平台（聚焦游戏/娱乐/社交）
# ===============================================================
platforms:
  enabled: true
  sources:
    # === 综合新闻（中文） ===
    - id: "toutiao"
      name: "今日头条"
    - id: "baidu"
      name: "百度热搜"
    - id: "thepaper"
      name: "澎湃新闻"
    - id: "ifeng"
      name: "凤凰网"
    - id: "tencent-hot"
      name: "腾讯新闻"

    # === 社交/短视频/娱乐（核心平台） ===
    - id: "weibo"
      name: "微博"
    - id: "douyin"
      name: "抖音"
    - id: "kuaishou"
      name: "快手"
    - id: "xiaohongshu"
      name: "小红书"
    - id: "bilibili-hot-search"
      name: "B站热搜"
    - id: "tieba"
      name: "贴吧"
    - id: "zhihu"
      name: "知乎"
    - id: "hupu"
      name: "虎扑"

    
# ===============================================================
# 3. 数据源 - RSS 订阅（精简）
# ===============================================================
rss:
  enabled: true                       # 启用 RSS（用于抖音非热榜追踪）

  freshness_filter:
    enabled: true
    max_age_days: 30

  feeds:
    # 抖音账号/话题/音乐等非热榜追踪（RSSHub 自建）
    # 使用方法：把 Douyin 账号/话题/音乐 ID 替换到 URL 中
    # 示例 URL（占位）：http://rsshub:1200/douyin/user/REPLACE_ME
    - id: "douyin_user_1"
      name: "抖音账号追踪-游戏"
      url: "http://rsshub:1200/douyin/user/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_game_creator_1"
      name: "抖音游戏内容UP主-1"
      url: "http://rsshub:1200/douyin/user/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_game_creator_2"
      name: "抖音游戏内容UP主-2"
      url: "http://rsshub:1200/douyin/user/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_game_creator_3"
      name: "抖音游戏内容UP主-3"
      url: "http://rsshub:1200/douyin/user/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_game_creator_4"
      name: "抖音游戏内容UP主-4"
      url: "http://rsshub:1200/douyin/user/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_game_creator_5"
      name: "抖音游戏内容UP主-5"
      url: "http://rsshub:1200/douyin/user/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_challenge_1"
      name: "抖音话题追踪-游戏"
      url: "http://rsshub:1200/douyin/challenge/REPLACE_ME"
      max_items: 30
      enabled: false

    - id: "douyin_music_1"
      name: "抖音音乐追踪-游戏"
      url: "http://rsshub:1200/douyin/music/REPLACE_ME"
      max_items: 30
      enabled: false

    # 小红书（RSSHub 支持用户/收藏/专辑；需要 XIAOHONGSHU_COOKIE）
    # 用户笔记：
    #   http://rsshub:1200/xiaohongshu/user/{user_id}/notes
    # 用户收藏：
    #   http://rsshub:1200/xiaohongshu/user/{user_id}/collect
    # 专辑：
    #   http://rsshub:1200/xiaohongshu/board/{board_id}

    - id: "xhs_user_1"
      name: "小红书用户-小游戏玩法"
      url: "http://rsshub:1200/xiaohongshu/user/5be4fc52d979de0001bdebeb/notes"
      max_items: 30
      enabled: true

    - id: "xhs_user_2"
      name: "小红书用户-游戏广告投放"
      url: "http://rsshub:1200/xiaohongshu/user/619d119d000000001000c123/notes"
      max_items: 30
      enabled: true

    - id: "xhs_user_3"
      name: "小红书用户-AI做游戏"
      url: "http://rsshub:1200/xiaohongshu/user/6321cd470000000023025c0b/notes"
      max_items: 30
      enabled: true

    - id: "xhs_user_4"
      name: "小红书用户-我在小红书做游戏"
      url: "http://rsshub:1200/xiaohongshu/user/REPLACE_ME/notes"
      max_items: 30
      enabled: false

    - id: "xhs_user_5"
      name: "小红书用户-独立游戏"
      url: "http://rsshub:1200/xiaohongshu/user/REPLACE_ME/notes"
      max_items: 30
      enabled: false

    - id: "xhs_board_1"
      name: "小红书专辑-小游戏玩法"
      url: "http://rsshub:1200/xiaohongshu/board/REPLACE_ME"
      max_items: 30
      enabled: false


# ===============================================================
# 4. 报告模式
# ===============================================================
report:
  mode: "current"
  display_mode: "keyword"
  sort_by_position_first: false
  rank_threshold: 5
  max_news_per_keyword: 0


# ===============================================================
# 5. 推送内容控制
# ===============================================================
display:
  region_order:
    - hot_events                      # 全网热点事件（跨平台聚合）
    - douyin_focus                    # 抖音游戏热度深度区
    - new_items                       # 新增热点
    - hotlist                         # 热榜匹配
    - ai_analysis                     # AI 分析

  regions:
    hot_events: true
    douyin_focus: true
    hotlist: true
    new_items: true
    rss: true                         # 开启 RSS 区域（用于抖音非热榜）
    standalone: false
    ai_analysis: true

  hot_events:
    max_items: 10
    min_platforms: 2

  douyin_focus:
    max_hot_items: 20                 # 抖音实时热度 Top
    max_rising_items: 12              # 抖音起量中 Top
    min_rank_improve: 8               # 认为“起量”的最小排名提升
    min_total_improve: 8              # 窗口累计提升阈值
    min_consecutive_improve: 1        # 连续提升步数阈值
    max_rank: 100                     # 只看前 N 名
    trend_points: 4                   # 展示最近 N 个排名点
    rising_window_points: 5           # 起量判断窗口点数
    allow_unfiltered_hot: true        # 无匹配时兜底展示抖音热榜（仍需命中 must_keywords）
    must_keywords:                    # 强制：必须包含以下任一关键词才视为“游戏相关”（抖音深度区）
      - 游戏
      - 手游
      - 小游戏
      - 版号
      - 开服
      - 公测
      - 联动
      - TapTap
      - Steam
    extra_keywords:                   # 抖音额外补充关键词（兜底匹配）
      - 游戏
      - 手游
      - 端游
      - 小游戏
      - H5游戏
      - 抖音小游戏
      - 抖音游戏
      - 游戏直播
      - 游戏主播
      - 游戏热度
      - 游戏圈
      - 上分
      - 皮肤
      - 抽卡
      - 游戏制作
      - 游戏开发
      - AI游戏
      - AI做游戏
      - AIGC
      - 联动
      - 版本更新
      - 新游
      - 公测
      - 内测
      - 预约
      - 上线
      - 王者荣耀
      - 和平精英
      - 逆水寒
      - 蛋仔派对
      - 原神
      - 崩坏
      - 星铁
      - 金铲铲

  rss_relax_keywords: true            # RSS 放宽关键词（展示全部 RSS）


# ===============================================================
# 6. 推送通知
# ===============================================================
notification:
  enabled: true

  push_window:
    enabled: false
    start: "09:00"
    end: "22:00"
    once_per_day: false

  channels:
    feishu:
      webhook_url: ""

    dingtalk:
      webhook_url: ""

    wework:
      webhook_url: ""
      msg_type: "markdown"

    telegram:
      bot_token: ""
      chat_id: ""

    email:
      from: ""
      password: ""
      to: ""
      smtp_server: ""
      smtp_port: ""

    ntfy:
      server_url: "https://ntfy.sh"
      topic: ""
      token: ""

    bark:
      url: ""

    slack:
      webhook_url: ""

    generic_webhook:
      webhook_url: ""
      payload_template: ""


# ===============================================================
# 7. 存储配置
# ===============================================================
storage:
  backend: "auto"
  formats:
    sqlite: true
    txt: false
    html: true

  local:
    data_dir: "output"
    retention_days: 0

  remote:
    retention_days: 0
    endpoint_url: ""
    bucket_name: ""
    access_key_id: ""
    secret_access_key: ""
    region: ""

  pull:
    enabled: false
    days: 7


# ===============================================================
# 8. AI 模型配置
# ===============================================================
ai:
  model: "deepseek/deepseek-chat"
  api_key: ""
  api_base: ""
  timeout: 120
  temperature: 1.0
  max_tokens: 5000
  num_retries: 1
  fallback_models: []


# ===============================================================
# 9. AI 分析功能
# ===============================================================
ai_analysis:
  enabled: true
  language: "Chinese"
  prompt_file: "ai_analysis_prompt.txt"
  max_news_for_analysis: 50
  include_rss: false
  include_rank_timeline: true


# ===============================================================
# 10. AI 翻译功能
# ===============================================================
ai_translation:
  enabled: false
  language: "English"
  prompt_file: "ai_translation_prompt.txt"


# ===============================================================
# 11. 短链接设置
# ===============================================================
shorturl:
  enabled: true                         # 启用短链接转换
  service: "tinyurl"                    # 服务：tinyurl, isgd, vgd
  timeout: 3                            # 超时时间（秒）


# ===============================================================
# 12. 高级设置
# ===============================================================
advanced:
  debug: false
  version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version"
  mcp_version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version_mcp"

  crawler:
    request_interval: 2000
    use_proxy: false
    default_proxy: "http://127.0.0.1:10801"

  rss:
    request_interval: 1000
    timeout: 15
    use_proxy: false
    proxy_url: ""

  weight:
    rank: 0.6
    frequency: 0.3
    hotness: 0.1

  max_accounts_per_channel: 3

  batch_size:
    default: 4000
    dingtalk: 20000
    feishu: 30000
    bark: 4000
    slack: 4000
  batch_send_interval: 3
  feishu_message_separator: "────────────"
